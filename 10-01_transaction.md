# 트랜젝션

데이터베이스를 조작하기 위한 하나의 논리적 단위를 이루는 연산의 집합

ACID 특징
* Atomic. 원자성: 하나의 트랙잰션에 포함된 모든 연산은 완전히 수행하거나 전혀 반영되지않음
* Consistency. 일관성: 특정 트랜젝션이 수행되기 전과 후에 데이터베이스가 일관된 상태를 유지
* Isolation. 고립성: 특정 트랙잰션이 데이터베이스를 갱신하는 동안 다른 트랜잭션에 의해 방해받지 않음
* Durability. 지속성: 완료된 트랜잭션의 결과는 어떠한 시스템의 장애에도 데이터베이스에 반영되어야 함

## 트랜잭션 연산

* Read(X): 데이터베이스에서 데이터 X 를 일고, 트랙잭션이 실행되는 메모리의 변수 X에 값을 저장
* Write(X): 트랙잭션이 실행되는 메모리에 있는 변수 X의 값을 데이터베이스에 저장

* Commit: 트랜젝션 연산에 의해 갱신된 데이터 항목의 값을 데이터베이스에 반영시키고 지속성을 확보하는 연산
* Rollback: 트랜잭션이 중단되기 이전까지 수행한 연산에 의해 갱신된 모든 데이터 항목의 값을 무효화하여 일관성을 확보하는 연산

### 5가지 상태

1. 동작: 트랜잭션이 시작을 준비 또는 실행 중인 상태
2. 부분 커밋: 마지막 연산을 실행한 직후의 상태
3. 커밋: 모든 실행이 성공적으로 완료된 후의 상태 ( 데이터베이스에 반영된 상태 )
4. 실패: 실행이 정상적으로 진행될 수 없는 상태
5. 중단: 실행 실패로 롤백되고 시작 이전의 상태로 환원된 상태

## 트랜잭션의 동시성

### 트랜잭션 동시 실행의 이점

* 트랜잭션 처리율과 자원 이용률을 향상
* 트랜잭션의 대기 시간을 감소

일관성 훼손 문제가 나타날 수 있으나, 다른 데이터를 동시 실행한다면 문제 없음

### 동시성 제어 (concurrency control)

다수의 트랜잭션이 성공적으로 동시에 실행되어도 일관성을 유지할 수 있도록 지원하는 기법

### 스케쥴(schedule) 

다수의 트랜잭션에 포함된 연산의 실행 순서를 명시한 것

* 직렬 스케쥴: 각 트랙잭션에 속한 모든 연산이 순차적으로 실행되는 스케쥴
* 병렬 스케쥴: 하나의 트잭잭션이 완료되기 전에 다른 트랜잭션이 실행되는 스케쥴 => 일관성 훼손이 발생 가능

### 직렬 가능 스케쥴

복수개의 트랜잭션이 동시에 수행된 결과가 직렬 스케쥴의 결과와 동일한 스케쥴

* 트랜잭션 간 연산 순서를 교환하여 트랜잭션을 직렬 스케쥴과 동등하게 변환이 가능한 스케쥴
* 사용된 Read 와 Write 연산 교환 시 상황에 따라 실행 결과에 일관성이 훼손되는 현상(충돌)이 발생

충돌 직렬성 : 순서 교환이 가능한 연산을 교환하여 직렬 스케쥴의 연산과 동등하게 변환이 가능한 스케쥴

## 트랜잭션의 회복

원자성을 보장하기 위해 트랜잭션 실패 시 실행된 모든 연산을 실행 이전 상태로 복원하는 기법

연쇄적 롤백 유발 가능

비연쇄적 스케쥴: 회복 가능하면서 배연쇄적 롤백을 만드는 것


