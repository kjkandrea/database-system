# 정규화

## 단점

* 사용 과정에서 많은 조인연산을 유발

## 좋은 릴레이션과 나쁜 릴레이션

### 나쁜 릴레이션의 예 : 데이터의 중복

* 일관성 유지 어려움
* 저장 공간 낭비

### 나쁜 릴레이션의 예 : 갱신 이상

* 삽입 이상
* 수정 이상
* 삭제 이상

### 고려 사항

릴레이션의 스키마가 얼마나 효율적으로 실세계를 반영하고 있는지 평가

* 한 릴레이션 내의 컬럼 간의 관계 분석
* 원하지 않는 데이터의 종속과 중복 제거
* 새로운 컬럼들이 데이터베이스에 추가될 때 기존 컬럼과의 관계 수정을 최소화

## 함수적 종속성

릴레이션 인스턴스를 분석하여 속성들 간의 연관관계를 표현한 것

릴레이션의 효율성을 향상시켜 좋은 릴레이션으로 변환하는데 이용되는 중요한 개념

`{등급}->{할인율}`

`{결정자}->{종속자}`

함수적 종속성을 릴레이션의 효율성 여부에 중요한 판단기준

### 추론 규칙

클로저 : 특정 속성 집합에서 파생될 수 있는 모든 속성들을 포함하는 집합

#### 암스트롱 공리

* 재귀성 규칙 : `X ⊇ Y` 이면 `X -> Y`
* 부가성 규칙 : `X -> Y` 이면 `XZ -> XZ`
* 이행성 규칙 : `X -> Y` 이고 `Y -> Z` 이면 `X -> Z`
* 분해 규칙 : `X -> YZ` 이면 `X -> Y`
* 합집합 규칙 : `X -> Y` 이고, `X -> Z` 이면 `X -> YZ`
* 의사 이행성 규칙 : `X -> Y` 이고, `WY -> Z`이면, `WX -> Z` 

#### 카노니컬 커버 (Canonical Cover)

`Fc`

함수적 종속성 추론 규칙으로 확장된 클로저에는 자명한 종속성과 중복된 종속성을 포함 => 의미가 여러 번 존재

불필요한 함수적 종속성을 제거한 표준형으로 변환 후 정규화를 수행

* 불필요한 속성 제거
* 중복된 종속성 제거
* 단일 속성 종속성

* 모든 함수적 종속성의 오른편 속성은 반드시 1개 ex: `{x, y} -> {z}`
* `F` 에서 `X -> A` 를 `X`의 진부분집합 `Y`에 대하여 `Y -> A`로 교체했을 때, 그 집합이 `F`와 동등한 집합이 불가능 => 불필요한 것 배제
* `F` 에서 어떤 함수적 종속성을 제거했을 때, 그 집합이 `F`와 동등한 집합이 불가능

## 정규화의 목적

정규화 : 특정 정규형의 조건을 만족하도록 릴레이션과 속성을 재구성하는 과정

* 데이터베이스 내에 모든 릴레이션을 효과적으로 표현
* 보다 간단한 관계 연산에 기초하여 검색 알고리즘을 효과적으로 작성할 수 있도록 지원
* 바람직하지 않은 삽입, 수정, 삭제 등의 이상 발생 방지
* 새로운 형태의 데이터가 삽입될 때 릴레이션 재구성의 필요성을 축소

### 함수적 종속성 다이어그램 (FDD)

`[결정자] -> [종속자]`

### 제 1정규형

릴레이션 스키마에서 정의된 모든 속성의 도메인이 **원자값**을 갖는 상태

1. 가장 조건이 단순한 정규형
2. 관계형 모델에 조건에 따라 자동 적용되는 정규형

### 제 2정규형

릴레이션이 제 1정규형을 만족하고 기본키의 부분집합이 특정 속성을 종속하고 있지 않은 상태

**2NF를 만족하지 않는 상태**

| 주문ID | 고객ID | 고객이름 | 주문일        |
|------|------|------|------------|
| 1    | 1    | 홍길동  | 2023-05-01 |
| 2    | 2    | 김철수  | 2023-05-02 |
| 3    | 1    | 홍길동  | 2023-05-03 |

**2NF를 만족하는 테이블**

| 고객ID | 고객이름 |
|------|------|
| 1    | 홍길동  |
| 2    | 김철수  |

| 주문ID | 고객ID | 주문일        |
|------|------|------------|
| 1    | 1    | 2023-05-01 |
| 2    | 2    | 2023-05-02 |
| 3    | 1    | 2023-05-03 |

### 제 3정규형

릴레이션이 제 2정규형을 만족하고, 기본키가 아닌 속성들이 어떤 키에도 이행적으로 종속되지 않은 상태

### BC정규형

릴레이션이 제3정규형을 만족하고 릴레이션에 성립하는 `X -> Y` 형태의 모든 함수적 종속성에 대하여 X가 수퍼키인 상태

