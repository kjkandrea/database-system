# 데이터 저장과 파일

## 물리적 저장장치의 구성

* 레지스터
* 캐시
* 메인 메모리
* 자기 디스크, 플래시 메모리
* 광학 디스크, 자기 테이프

## 데이터베이스의 구성 요소

* 파일 : 데이터를 영구적으로 저장하기 위한 가장 기초적인 논리 구조
* 블럭 : 파일을 고정적인 길이로 분할하여 생기는 균등한 크기의 데이터 묶음
* 레코드 : 블록을 구성하는 요소. 더이상 분리될 수 없는 최소데이터 저장단위

### 고정 길이 레코드

모든 레코드의 바이트 크기가 동일하기에 i번째 레코드에 접근하기 용이함

* 레코드 삭제시 해당 레코드가 저장된 위치에 빈공간이 생성
* 장시간 레코드의 삽입 및 삭제 발생 시, 저장 공간에 많은 낭비가 발생

따라서 빈 영역을 마지막 레코드를 옮겨서 조정하거나, 순서대로 끌어올리거나, 가용 리스트를 관리해야함

### 가변 길이 레코드

* 한 블럭 내에 저장되는 레코드 유형이 둘 이상 일 때
* 길이가 고정되지 않은 컬럼의 개수가 하나 이상
* 레코드가 멀티셋(컬럼 값이 여러 개)을 허용한 컬럼을 가질 때

슬롯페이지 구조. 블럭 헤더에 레코드 요약 정보와 링크를 저장

## 파일 구조화 방법

### 힙 파일 구조

저장순서 고려없이 파일 내 임의의 위치에 배치

* 저장속도 가장 빠름
* 검색속도가 느림

### 순차 파일 구조

레코드들이 정렬되어 저장

가장 많이 사용

오버플로우 블럭을 통해 인덱스를 재조정하지 않으면서 저장 속도를 빠르게 할 수 있음.

* 이진탐색 가능

### 해시 파일 구조

해시 함수를 사용하여 블럭 주소를 계산

* 해시함수의 구조에 따라 성능차가 많이 남

## 저장장치 적근

* 사용 중인 블럭을 지속석으로 메모리에 적재
* 한정된 공간으로 인해 필요에 따라 특정 블럭 할당 해제
* 이를 효율적으로 달성할 알고리즘이 필요 => 버퍼 관리자

### 버퍼 관리자

DBMS 는 버퍼 관리자에게 필요한 블럭을 요청

버퍼관리자는 메모리에 블럭을 교체하는 **버퍼 교체 전략**을 사용

* 도중 중단된 작업 결과물이 디스크에 기록되는 것을 방지
* 디스크 블럭의 교체 관리

블럭 강제 출력 : 강제로 디스크에 저장하는 것

* 시스템 로그와 같이 중요한 데이터 디스크에 저장

### 버퍼 교체 전략

* LRU(Least Recently Used) : 최근에 가장 적게 참조된 블럭을 우선 교체
* MFU(Most Frequently Used) : 특정 기간동안 가장 여러번 사용된 블럭을 선택하여 교체

